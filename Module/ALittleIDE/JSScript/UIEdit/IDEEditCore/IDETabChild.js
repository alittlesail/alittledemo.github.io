{
if (typeof ALittleIDE === "undefined") ALittleIDE = {};
let ___all_struct = ALittle.GetAllStruct();

ALittle.RegStruct(1290936016, "ALittleIDE.IDETabChildHandleInfo", {
name : "ALittleIDE.IDETabChildHandleInfo", ns_name : "ALittleIDE", rl_name : "IDETabChildHandleInfo", hash_code : 1290936016,
name_list : ["display_group","handle_quad","focus_quad","size_quad_container","target","buttondown_lock","delta_x","delta_y","lock_x_or_y","delta_width","delta_height","lock_width_or_height"],
type_list : ["ALittle.DisplayObject","ALittle.DisplayObject","ALittle.DisplayObject","ALittle.DisplayObject","ALittleIDE.IDETreeLogic","bool","double","double","bool","double","double","bool"],
option_map : {}
})
ALittle.RegStruct(322885752, "ALittleIDE.IDETabChildControlLine", {
name : "ALittleIDE.IDETabChildControlLine", ns_name : "ALittleIDE", rl_name : "IDETabChildControlLine", hash_code : 322885752,
name_list : ["quad","size_quad","size_quad_container"],
type_list : ["ALittle.DisplayObject","ALittle.DisplayObject","ALittle.DisplayObject"],
option_map : {}
})
ALittle.RegStruct(-1328054622, "ALittleIDE.IDETabChildSearchInfo", {
name : "ALittleIDE.IDETabChildSearchInfo", ns_name : "ALittleIDE", rl_name : "IDETabChildSearchInfo", hash_code : -1328054622,
name_list : ["name","index"],
type_list : ["string","int"],
option_map : {}
})
ALittle.RegStruct(-1068858139, "ALittleIDE.IDETabChildQuickDragAddUserData", {
name : "ALittleIDE.IDETabChildQuickDragAddUserData", ns_name : "ALittleIDE", rl_name : "IDETabChildQuickDragAddUserData", hash_code : -1068858139,
name_list : ["abs_x","abs_y","control_name"],
type_list : ["double","double","string"],
option_map : {}
})
ALittle.RegStruct(-1479093282, "ALittle.UIEvent", {
name : "ALittle.UIEvent", ns_name : "ALittle", rl_name : "UIEvent", hash_code : -1479093282,
name_list : ["target"],
type_list : ["ALittle.DisplayObject"],
option_map : {}
})
ALittle.RegStruct(-1347278145, "ALittle.UIButtonEvent", {
name : "ALittle.UIButtonEvent", ns_name : "ALittle", rl_name : "UIButtonEvent", hash_code : -1347278145,
name_list : ["target","abs_x","abs_y","rel_x","rel_y","count","is_drag"],
type_list : ["ALittle.DisplayObject","double","double","double","double","int","bool"],
option_map : {}
})
ALittle.RegStruct(1883782801, "ALittle.UILButtonDownEvent", {
name : "ALittle.UILButtonDownEvent", ns_name : "ALittle", rl_name : "UILButtonDownEvent", hash_code : 1883782801,
name_list : ["target","abs_x","abs_y","rel_x","rel_y","count","is_drag"],
type_list : ["ALittle.DisplayObject","double","double","double","double","int","bool"],
option_map : {}
})
ALittle.RegStruct(-431205740, "ALittle.UIResizeEvent", {
name : "ALittle.UIResizeEvent", ns_name : "ALittle", rl_name : "UIResizeEvent", hash_code : -431205740,
name_list : ["target"],
type_list : ["ALittle.DisplayObject"],
option_map : {}
})
ALittle.RegStruct(40651933, "ALittle.UILButtonUpEvent", {
name : "ALittle.UILButtonUpEvent", ns_name : "ALittle", rl_name : "UILButtonUpEvent", hash_code : 40651933,
name_list : ["target","abs_x","abs_y","rel_x","rel_y","count","is_drag"],
type_list : ["ALittle.DisplayObject","double","double","double","double","int","bool"],
option_map : {}
})
ALittle.RegStruct(1337289812, "ALittle.UIButtonDragEvent", {
name : "ALittle.UIButtonDragEvent", ns_name : "ALittle", rl_name : "UIButtonDragEvent", hash_code : 1337289812,
name_list : ["target","rel_x","rel_y","delta_x","delta_y","abs_x","abs_y"],
type_list : ["ALittle.DisplayObject","double","double","double","double","double","double"],
option_map : {}
})
ALittle.RegStruct(1301789264, "ALittle.UIButtonDragBeginEvent", {
name : "ALittle.UIButtonDragBeginEvent", ns_name : "ALittle", rl_name : "UIButtonDragBeginEvent", hash_code : 1301789264,
name_list : ["target","rel_x","rel_y","delta_x","delta_y","abs_x","abs_y"],
type_list : ["ALittle.DisplayObject","double","double","double","double","double","double"],
option_map : {}
})
ALittle.RegStruct(150587926, "ALittle.UIButtonDragEndEvent", {
name : "ALittle.UIButtonDragEndEvent", ns_name : "ALittle", rl_name : "UIButtonDragEndEvent", hash_code : 150587926,
name_list : ["target","rel_x","rel_y","delta_x","delta_y","abs_x","abs_y"],
type_list : ["ALittle.DisplayObject","double","double","double","double","double","double"],
option_map : {}
})
ALittle.RegStruct(-641444818, "ALittle.UIRButtonDownEvent", {
name : "ALittle.UIRButtonDownEvent", ns_name : "ALittle", rl_name : "UIRButtonDownEvent", hash_code : -641444818,
name_list : ["target","abs_x","abs_y","rel_x","rel_y","count","is_drag"],
type_list : ["ALittle.DisplayObject","double","double","double","double","int","bool"],
option_map : {}
})
ALittle.RegStruct(882286932, "ALittle.UIKeyEvent", {
name : "ALittle.UIKeyEvent", ns_name : "ALittle", rl_name : "UIKeyEvent", hash_code : 882286932,
name_list : ["target","mod","sym","scancode","custom","handled"],
type_list : ["ALittle.DisplayObject","int","int","int","bool","bool"],
option_map : {}
})
ALittle.RegStruct(-1604617962, "ALittle.UIKeyDownEvent", {
name : "ALittle.UIKeyDownEvent", ns_name : "ALittle", rl_name : "UIKeyDownEvent", hash_code : -1604617962,
name_list : ["target","mod","sym","scancode","custom","handled"],
type_list : ["ALittle.DisplayObject","int","int","int","bool","bool"],
option_map : {}
})
ALittle.RegStruct(544684311, "ALittle.UIMoveInEvent", {
name : "ALittle.UIMoveInEvent", ns_name : "ALittle", rl_name : "UIMoveInEvent", hash_code : 544684311,
name_list : ["target"],
type_list : ["ALittle.DisplayObject"],
option_map : {}
})
ALittle.RegStruct(-1202439334, "ALittle.UIMoveOutEvent", {
name : "ALittle.UIMoveOutEvent", ns_name : "ALittle", rl_name : "UIMoveOutEvent", hash_code : -1202439334,
name_list : ["target"],
type_list : ["ALittle.DisplayObject"],
option_map : {}
})
ALittle.RegStruct(-449066808, "ALittle.UIClickEvent", {
name : "ALittle.UIClickEvent", ns_name : "ALittle", rl_name : "UIClickEvent", hash_code : -449066808,
name_list : ["target","is_drag"],
type_list : ["ALittle.DisplayObject","bool"],
option_map : {}
})

ALittleIDE.IDETabChild = JavaScript.Class(undefined, {
	Ctor : function(name, save) {
		this._name = name;
		this._save = save;
		this._group = ALittle.CreateKeyWeakMap();
		this._tab_body = ALittleIDE.g_Control.CreateControl("ide_edit_tab_screen", this);
		this._tree_screen = ALittleIDE.g_Control.CreateControl("ide_edit_tree_screen", this);
		this._control_screen = ALittleIDE.g_Control.CreateControl("ide_edit_control_screen", this);
		this._anti_panel = ALittleIDE.g_Control.CreateControl("ide_edit_anti_panel", this);
		this._tree_object = undefined;
		this._tab_screen.container = ALittle.NewObject(ALittle.DisplayGroup, ALittleIDE.g_Control);
		this._tab_screen.container.scale_x = 1;
		this._tab_screen.container.scale_y = 1;
		this._tab_container.width = ALittleIDE.g_IDEProject.project.config.GetConfig("default_show_width", 800);
		this._tab_container.height = ALittleIDE.g_IDEProject.project.config.GetConfig("default_show_height", 600);
		this._tab_screen.RejustScrollBar();
		this._tab_select_container.visible = ALittleIDE.g_IDEUICenter.singleselect;
		this._tab_handle_quad.AddEventListener(___all_struct.get(1883782801), this, this.HandleHandleContainerLButtonDown);
		this._tab_quad_container.RemoveAllChild();
		this._tab_quad_map = new Map();
		this._tab_handdrag_container.visible = ALittleIDE.g_IDEUICenter.handdrag;
		this._tab_handdrag_quad.drag_trans_target = this._tab_screen;
		this._tab_dragadd_container.visible = false;
		this._tab_scale_container.visible = ALittleIDE.g_IDEUICenter.scale;
		this._tab_scale_quad.AddEventListener(___all_struct.get(1883782801), this, this.HandleScaleContainerLButtonDown);
		this._tree_search_info = {};
		this._tree_search_info.name = "";
		this._tree_search_info.index = 0;
		this._tab_body._user_data = this;
		this._tree_screen._user_data = this;
		this._revoke_list = ALittle.NewObject(ALittleIDE.IDERevokeList);
		this._tree_loop_x = undefined;
		this._tree_loop_y = undefined;
	},
	HandleTreeSizeChanged : function(event) {
		this._tree_screen.RejustScrollBar();
	},
	get name() {
		return this._name;
	},
	get tab_screen() {
		return this._tab_screen;
	},
	get tab_body() {
		return this._tab_body;
	},
	get tree_screen() {
		return this._tree_screen;
	},
	get control_screen() {
		return this._control_screen;
	},
	get anti_panel() {
		return this._anti_panel;
	},
	get group() {
		return this._group;
	},
	get revoke_list() {
		return this._revoke_list;
	},
	get tree_object() {
		return this._tree_object;
	},
	get save() {
		return this._save;
	},
	Save : function(value) {
		if (this._save === value) {
			return [true, undefined];
		}
		if (value === false) {
			this._save = false;
			this.UpdateTitle();
			return [true, undefined];
		}
		if (this._tree_object === undefined) {
			return [false, "根节点不存在，不能保存"];
		}
		let info = this._tree_object.CalcInfo();
		let [result, content] = ALittleIDE.g_IDEProject.SaveControl(this._name, info);
		if (result === false) {
			return [false, content];
		}
		this._save = value;
		this.UpdateTitle();
		return [true, undefined];
	},
	Rename : function(name) {
		this._name = name;
		this.UpdateTitle();
	},
	UpdateTitle : function() {
		if (this._tree_object === undefined) {
			return;
		}
		let text = this._tree_object.GetDesc();
		if (text === "") {
			text = this._name;
			if (ALittle.String_Len(this._name) > 15) {
				text = "..." + ALittle.String_Sub(this._name, -15, -1);
			}
		}
		if (this._save === false) {
			text = text + " *";
		}
		ALittleIDE.g_IDETabManager.main_tab.SetChildText(this._tab_body, text);
	},
	get total_title() {
		let text = this._tree_object.GetDesc();
		if (text === "") {
			return this._name;
		}
		return this._name + "(" + text + ")";
	},
	SetEditWH : function(width, height) {
		this._tab_container.width = width;
		this._tab_container.height = height;
		this._tab_screen.RejustScrollBar();
		for (let [target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			this.UpdateHandleQuadLayout(target);
		}
	},
	CanDeleteControl : function(name) {
		if (this._tree_object === undefined) {
			return [true, undefined];
		}
		let info = this._tree_object.CalcInfo();
		let map = ALittleIDE.IDEUtility_GetExtends(info);
		if (map[name]) {
			return [false, "被其他控件引用:" + name];
		}
		return [true, undefined];
	},
	SelectAlign : function(align_type) {
		let count = 0;
		let first_target = undefined;
		for (let [target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			count = count + 1;
			first_target = target;
		}
		if (count === 0) {
			return;
		}
		if (first_target === this._tree_object) {
			return;
		}
		if (count === 1) {
			let parent = first_target.logic_parent;
			let parent_object = parent.user_info.object;
			let drag_x = 0.0;
			let drag_y = 0.0;
			let target_object = first_target.user_info.object;
			if (align_type === "h_align_left") {
				drag_x = -target_object.x;
			} else if (align_type === "h_align_center") {
				drag_x = (parent_object.width - target_object.width) / 2 - target_object.x;
			} else if (align_type === "h_align_right") {
				drag_x = (parent_object.width - target_object.width) - target_object.x;
			} else if (align_type === "v_align_top") {
				drag_y = -target_object.y;
			} else if (align_type === "v_align_center") {
				drag_y = (parent_object.height - target_object.height) / 2 - target_object.y;
			} else if (align_type === "v_align_bottom") {
				drag_y = (parent_object.height - target_object.height) - target_object.y;
			}
			first_target.DragXY(drag_x, drag_y);
			this.UpdateHandleQuadLayout(first_target);
			let revoke = ALittle.NewObject(ALittleIDE.IDEDragXYRevoke, first_target, drag_x, drag_y);
			this._revoke_list.PushRevoke(revoke);
		} else {
			let revoke_bind = ALittle.NewObject(ALittleIDE.IDERevokeBind);
			if (align_type === "h_align_left") {
				let common = first_target.user_info.object.x;
				for (let [target, v] of this._tab_quad_map) {
					if (v === undefined) continue;
					if (target.user_info.object.x < common) {
						common = target.user_info.object.x;
					}
				}
				for (let [target, v] of this._tab_quad_map) {
					if (v === undefined) continue;
					let drag_x = common - target.user_info.object.x;
					target.DragXY(drag_x, 0);
					this.UpdateHandleQuadLayout(target);
					let revoke = ALittle.NewObject(ALittleIDE.IDEDragXYRevoke, target, drag_x, 0);
					revoke_bind.PushRevoke(revoke);
				}
			} else if (align_type === "h_align_center") {
				let common = 0.0;
				for (let [target, v] of this._tab_quad_map) {
					if (v === undefined) continue;
					common = common + target.user_info.object.x + target.user_info.object.width / 2;
				}
				common = common / count;
				for (let [target, v] of this._tab_quad_map) {
					if (v === undefined) continue;
					let drag_x = common - (target.user_info.object.x + target.user_info.object.width / 2);
					target.DragXY(drag_x, 0);
					this.UpdateHandleQuadLayout(target);
					let revoke = ALittle.NewObject(ALittleIDE.IDEDragXYRevoke, target, drag_x, 0);
					revoke_bind.PushRevoke(revoke);
				}
			} else if (align_type === "h_align_right") {
				let common = first_target.user_info.object.x + first_target.user_info.object.width;
				for (let [target, v] of this._tab_quad_map) {
					if (v === undefined) continue;
					if (target.user_info.object.x + target.user_info.object.width > common) {
						common = target.user_info.object.x + target.user_info.object.width;
					}
				}
				for (let [target, v] of this._tab_quad_map) {
					if (v === undefined) continue;
					let drag_x = common - (target.user_info.object.x + target.user_info.object.width);
					target.DragXY(drag_x, 0);
					this.UpdateHandleQuadLayout(target);
					let revoke = ALittle.NewObject(ALittleIDE.IDEDragXYRevoke, target, drag_x, 0);
					revoke_bind.PushRevoke(revoke);
				}
			} else if (align_type === "v_align_top") {
				let common = first_target.user_info.object.y;
				for (let [target, v] of this._tab_quad_map) {
					if (v === undefined) continue;
					if (target.user_info.object.y < common) {
						common = target.user_info.object.y;
					}
				}
				for (let [target, v] of this._tab_quad_map) {
					if (v === undefined) continue;
					let drag_y = common - target.user_info.object.y;
					target.DragXY(0, drag_y);
					this.UpdateHandleQuadLayout(target);
					let revoke = ALittle.NewObject(ALittleIDE.IDEDragXYRevoke, target, 0, drag_y);
					revoke_bind.PushRevoke(revoke);
				}
			} else if (align_type === "v_align_center") {
				let common = 0.0;
				for (let [target, v] of this._tab_quad_map) {
					if (v === undefined) continue;
					common = common + target.user_info.object.y + target.user_info.object.height / 2;
				}
				common = common / count;
				for (let [target, v] of this._tab_quad_map) {
					if (v === undefined) continue;
					let drag_y = common - (target.user_info.object.y + target.user_info.object.height / 2);
					target.DragXY(0, drag_y);
					this.UpdateHandleQuadLayout(target);
					let revoke = ALittle.NewObject(ALittleIDE.IDEDragXYRevoke, target, 0, drag_y);
					revoke_bind.PushRevoke(revoke);
				}
			} else if (align_type === "v_align_bottom") {
				let common = first_target.user_info.object.y + first_target.user_info.object.height;
				for (let [target, v] of this._tab_quad_map) {
					if (v === undefined) continue;
					if (target.user_info.object.y + target.user_info.object.height > common) {
						common = target.user_info.object.y + target.user_info.object.height;
					}
				}
				for (let [target, v] of this._tab_quad_map) {
					if (v === undefined) continue;
					let drag_y = common - (target.user_info.object.y + target.user_info.object.height);
					target.DragXY(0, drag_y);
					this.UpdateHandleQuadLayout(target);
					let revoke = ALittle.NewObject(ALittleIDE.IDEDragXYRevoke, target, 0, drag_y);
					revoke_bind.PushRevoke(revoke);
				}
			}
			this._revoke_list.PushRevoke(revoke_bind);
		}
		this.Save(false);
	},
	ShowSelectLayer : function(value) {
		this._tab_select_container.visible = value;
	},
	ShowHandDragLayer : function(value) {
		this._tab_handdrag_container.visible = value;
	},
	ShowScaleLayer : function(value) {
		this._tab_scale_container.visible = value;
	},
	CreateByNew : function(type) {
		let info = {};
		info.__class = type;
		let object = ALittle.NewObject(ALittle[type], ALittleIDE.g_IDEProject.project.control);
		ALittleIDE.IDEUtility_NewGiveBaseCase(info, object);
		this._tab_object_container.AddChild(object);
		this._tree_object = ALittleIDE.IDEUtility_CreateTree(info, false, object, undefined, this, true);
		this._tree_object.AddEventListener(___all_struct.get(-431205740), this, this.HandleTreeSizeChanged);
		this._tree_screen.AddChild(this._tree_object);
		this._anti_panel.Init(this);
	},
	CreateByExtends : function(extends_v) {
		let info = {};
		info.__extends = extends_v;
		let object = ALittleIDE.g_IDEProject.project.control.CreateControl(extends_v);
		this._tab_object_container.AddChild(object);
		this._tree_object = ALittleIDE.IDEUtility_CreateTree(info, false, object, undefined, this, true);
		this._tree_object.AddEventListener(___all_struct.get(-431205740), this, this.HandleTreeSizeChanged);
		this._tree_screen.AddChild(this._tree_object);
		this._anti_panel.Init(this);
	},
	CreateBySelect : function(info) {
		let object = ALittleIDE.g_IDEProject.project.control.CreateControl(this._name);
		this._tab_object_container.AddChild(object);
		this._tree_object = ALittleIDE.IDEUtility_CreateTree(info, false, object, undefined, this, true);
		this._tree_object.AddEventListener(___all_struct.get(-431205740), this, this.HandleTreeSizeChanged);
		this._tree_screen.AddChild(this._tree_object);
		this._anti_panel.Init(this);
	},
	IsShowHandleQuad : function(target) {
		return this._tab_quad_map.get(target) !== undefined;
	},
	FocusInHandleQuad : function(target) {
		let handle_info = this._tab_quad_map.get(target);
		if (handle_info === undefined) {
			return;
		}
		A_UISystem.focus = handle_info.focus_quad;
	},
	ShowHandleQuad : function(target, force_shift) {
		let shift = (A_UISystem.sym_map.get(1073742049) !== undefined || A_UISystem.sym_map.get(1073742053) !== undefined);
		if (force_shift) {
			shift = true;
		}
		if (shift === false) {
			this._tab_quad_map = new Map();
			this._tab_quad_container.RemoveAllChild();
		}
		let handle_info = this._tab_quad_map.get(target);
		if (handle_info !== undefined) {
			return;
		}
		let common_parent = undefined;
		let has_target = false;
		for (let [tree_target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			common_parent = tree_target.logic_parent;
			has_target = true;
			break;
		}
		if (has_target && common_parent !== target.logic_parent) {
			return;
		}
		let control_line = {};
		let handle_quad = ALittleIDE.g_Control.CreateControl("ide_common_handle_quad", control_line);
		control_line.quad.AddEventListener(___all_struct.get(40651933), this, this.HandleHandleQuadLButtonUp);
		control_line.quad.AddEventListener(___all_struct.get(1883782801), this, this.HandleHandleQuadLButtonDown);
		control_line.quad.AddEventListener(___all_struct.get(1301789264), this, this.HandleHandleQuadDragBegin);
		control_line.quad.AddEventListener(___all_struct.get(1337289812), this, this.HandleHandleQuadDrag);
		control_line.quad.AddEventListener(___all_struct.get(150587926), this, this.HandleHandleQuadDragEnd);
		control_line.quad.AddEventListener(___all_struct.get(-641444818), this, this.HandleHandleQuadRButtonDown);
		control_line.quad.AddEventListener(___all_struct.get(-1604617962), this, this.HandleHandleQuadKeyDown);
		control_line.size_quad.AddEventListener(___all_struct.get(-1604617962), this, this.HandleHandleSizeQuadKeyDown);
		control_line.size_quad.AddEventListener(___all_struct.get(1301789264), this, this.HandleHandleSizeQuadDragBegin);
		control_line.size_quad.AddEventListener(___all_struct.get(1337289812), this, this.HandleHandleSizeQuadDrag);
		control_line.size_quad.AddEventListener(___all_struct.get(150587926), this, this.HandleHandleSizeQuadDragEnd);
		control_line.size_quad.AddEventListener(___all_struct.get(544684311), this, this.HandleHandleSizeQuadMoveIn);
		control_line.size_quad.AddEventListener(___all_struct.get(-1202439334), this, this.HandleHandleSizeQuadMoveOut);
		handle_info = {};
		let target_parent = target.user_info.object;
		let quad_parent = handle_quad;
		while (target_parent !== undefined) {
			quad_parent.x = target_parent.x;
			quad_parent.y = target_parent.y;
			quad_parent.width = target_parent.width;
			quad_parent.height = target_parent.height;
			quad_parent.scale_x = target_parent.scale_x;
			quad_parent.scale_y = target_parent.scale_y;
			quad_parent.center_x = target_parent.center_x;
			quad_parent.center_y = target_parent.center_y;
			quad_parent.angle = target_parent.angle;
			let display_group = ALittle.NewObject(ALittle.DisplayGroup, ALittleIDE.g_Control);
			display_group.AddChild(quad_parent);
			if (target_parent.show_parent === this._tab_object_container) {
				handle_info.display_group = display_group;
				this._tab_quad_container.AddChild(display_group);
				break;
			}
			quad_parent = display_group;
			target_parent = target_parent.show_parent;
		}
		handle_info.handle_quad = handle_quad;
		handle_info.focus_quad = control_line.quad;
		handle_info.size_quad_container = control_line.size_quad_container;
		control_line.quad._user_data = handle_info;
		control_line.size_quad._user_data = handle_info;
		target.ShowAttributePanel();
		handle_info.target = target;
		this._tab_quad_map.set(target, handle_info);
		let loop = ALittle.NewObject(ALittle.LoopFunction, this.FocusInHandleQuad.bind(this, target), 1, 0, 1);
		loop.Start();
	},
	HideHandleQuad : function(target, shift) {
		let handle_info = this._tab_quad_map.get(target);
		if (handle_info === undefined) {
			return;
		}
		if (shift === undefined) {
			shift = (A_UISystem.sym_map.get(1073742049) !== undefined || A_UISystem.sym_map.get(1073742053) !== undefined);
		}
		if (shift === false) {
			this._tab_quad_map = new Map();
			this._tab_quad_container.RemoveAllChild();
			target.ShowAttributePanel();
			this._tab_quad_map.set(handle_info.target, handle_info);
			this._tab_quad_container.AddChild(handle_info.display_group);
			return;
		}
		this._tab_quad_container.RemoveChild(handle_info.display_group);
		this._tab_quad_map.delete(handle_info.target);
	},
	UpdateHandleQuadLayout : function(target) {
		let handle_info = this._tab_quad_map.get(target);
		if (handle_info === undefined) {
			return;
		}
		handle_info.handle_quad.x = target.user_info.object.x;
		handle_info.handle_quad.y = target.user_info.object.y;
		handle_info.handle_quad.width = target.user_info.object.width;
		handle_info.handle_quad.height = target.user_info.object.height;
		handle_info.handle_quad.scale_x = target.user_info.object.scale_x;
		handle_info.handle_quad.scale_y = target.user_info.object.scale_y;
		handle_info.handle_quad.center_x = target.user_info.object.center_x;
		handle_info.handle_quad.center_y = target.user_info.object.center_y;
		handle_info.handle_quad.angle = target.user_info.object.angle;
	},
	UpdateHandleQuadRemove : function(target) {
		let handle_info = this._tab_quad_map.get(target);
		if (handle_info === undefined) {
			return;
		}
		this._tab_quad_container.RemoveChild(handle_info.handle_quad);
		this._tab_quad_map.delete(target);
	},
	HandleHandleContainerLButtonDown : function(event) {
		if (this._tree_object === undefined) {
			return;
		}
		let target = this._tree_object.EditPickUp(event.rel_x, event.rel_y);
		if (target === undefined) {
			return;
		}
		this.ShowHandleQuad(target);
	},
	HandleSelectRightExItemClick : function(event) {
		A_LayerManager.HideFromRight(this._select_right_exmenu);
		this._tab_right_exlinear.RemoveAllChild();
		let tree = event.target._user_data;
		if (tree === undefined) {
			return;
		}
		this.ShowHandleQuad(tree);
	},
	HandleScaleContainerLButtonDown : function(event) {
		let shift = (A_UISystem.sym_map.get(1073742049) !== undefined || A_UISystem.sym_map.get(1073742053) !== undefined);
		let scale = this._tab_screen.container.scale_x;
		if (shift) {
			scale = scale - 0.1;
			if (scale < 0) {
				scale = 0;
			}
		} else {
			scale = scale + 0.1;
		}
		this._tab_screen.container.scale_x = scale;
		this._tab_screen.container.scale_y = scale;
		this._tab_screen.RejustScrollBar();
		ALittleIDE.g_IDEUICenter.UpdateToolScale(scale);
	},
	SetScale : function(scale) {
		this._tab_screen.container.scale_x = scale;
		this._tab_screen.container.scale_y = scale;
		this._tab_screen.RejustScrollBar();
	},
	GetScale : function() {
		return this._tab_screen.container.scale_x;
	},
	HandleHandleQuadLButtonDown : function(event) {
		let handle_info = event.target._user_data;
		handle_info.buttondown_lock = true;
	},
	HandleHandleQuadLButtonUp : function(event) {
		let handle_info = event.target._user_data;
		if (handle_info.buttondown_lock !== true) {
			return;
		}
		this.HideHandleQuad(handle_info.target);
	},
	ControlCopyInfoCmp : function(a, b) {
		return a.index < b.index;
	},
	HandleHandleQuadKeyDown : function(event) {
		if (event.sym === 99 && ALittle.BitAnd(event.mod, 0x00c0) !== 0) {
			let copy_list = [];
			let copy_list_count = 0;
			for (let [target, handle_info] of this._tab_quad_map) {
				if (handle_info === undefined) continue;
				if (handle_info.target.logic_parent !== undefined) {
					let info = {};
					info.index = handle_info.target.logic_parent.GetChildIndex(handle_info.target);
					info.info = handle_info.target.CalcInfo();
					++ copy_list_count;
					copy_list[copy_list_count - 1] = info;
				}
			}
			if (copy_list_count > 0) {
				ALittle.List_Sort(copy_list, ALittleIDE.IDETabChild.ControlCopyInfoCmp);
				ALittle.System_SetClipboardText(ALittle.String_JsonEncode(copy_list));
			}
			return;
		}
		if (event.sym === 120 && ALittle.BitAnd(event.mod, 0x00c0) !== 0) {
			let copy_list = [];
			let copy_list_count = 0;
			for (let [target, handle_info] of this._tab_quad_map) {
				if (handle_info === undefined) continue;
				let info = {};
				info.index = handle_info.target.logic_parent.GetChildIndex(handle_info.target);
				info.info = handle_info.target.CalcInfo();
				++ copy_list_count;
				copy_list[copy_list_count - 1] = info;
			}
			if (copy_list_count > 0) {
				ALittle.List_Sort(copy_list, ALittleIDE.IDETabChild.ControlCopyInfoCmp);
				ALittle.System_SetClipboardText(ALittle.String_JsonEncode(copy_list));
				let revoke_bind = ALittle.NewObject(ALittleIDE.IDERevokeBind);
				for (let [target, handle_info] of this._tab_quad_map) {
					if (handle_info === undefined) continue;
					handle_info.target.TreeCut(revoke_bind);
				}
				this._revoke_list.PushRevoke(revoke_bind);
			}
			return;
		}
		if (event.sym === 127) {
			let revoke_bind = ALittle.NewObject(ALittleIDE.IDERevokeBind);
			let has_target = false;
			for (let [target, handle_info] of this._tab_quad_map) {
				if (handle_info === undefined) continue;
				handle_info.target.TreeDelete(revoke_bind);
				has_target = true;
			}
			if (has_target) {
				this._tab_quad_map = new Map();
				this._tab_quad_container.RemoveAllChild();
				this._revoke_list.PushRevoke(revoke_bind);
			}
			return;
		}
		if (event.sym === 118 && ALittle.BitAnd(event.mod, 0x00c0) !== 0) {
			let handle_info = event.target._user_data;
			let common_parent = handle_info.target.logic_parent;
			let child_index = 1;
			if (common_parent === undefined) {
				common_parent = handle_info.target;
			} else {
				child_index = common_parent.GetChildIndex(handle_info.target);
			}
			this.RightControlTreePasteImpl(common_parent, undefined, child_index);
			return;
		}
		let delta_x = 0;
		let delta_y = 0;
		if (event.sym === 1073741904) {
			delta_x = -1;
		} else if (event.sym === 1073741903) {
			delta_x = 1;
		} else if (event.sym === 1073741906) {
			delta_y = -1;
		} else if (event.sym === 1073741905) {
			delta_y = 1;
		} else {
			return;
		}
		let common_parent = undefined;
		for (let [tree_target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			common_parent = tree_target.logic_parent;
			break;
		}
		if (common_parent === undefined) {
			return;
		}
		if (ALittleIDE.g_IDEEnum.can_move_child_map[common_parent.user_info.default.__class] === undefined) {
			return;
		}
		let revoke_bind = ALittle.NewObject(ALittleIDE.IDERevokeBind);
		let has_target = false;
		for (let [target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			target.DragXY(delta_x, delta_y);
			this.UpdateHandleQuadLayout(target);
			has_target = true;
			let revoke = ALittle.NewObject(ALittleIDE.IDEDragXYRevoke, target, delta_x, delta_y);
			revoke_bind.PushRevoke(revoke);
		}
		if (has_target === false) {
			return;
		}
		this._revoke_list.PushRevoke(revoke_bind);
		this.Save(false);
	},
	HandleHandleQuadDragBegin : function(event) {
		let common_parent = undefined;
		for (let [tree_target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			common_parent = tree_target.logic_parent;
			break;
		}
		if (common_parent === undefined) {
			return;
		}
		if (ALittleIDE.g_IDEEnum.can_move_child_map[common_parent.user_info.default.__class] === undefined) {
			return;
		}
		for (let [target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			handle_info.delta_x = 0;
			handle_info.delta_y = 0;
			handle_info.lock_x_or_y = ALittle.Math_Abs(event.delta_x) > ALittle.Math_Abs(event.delta_y);
			handle_info.buttondown_lock = false;
		}
		this.Save(false);
	},
	HandleHandleQuadDrag : function(event) {
		let common_parent = undefined;
		for (let [tree_target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			common_parent = tree_target.logic_parent;
			break;
		}
		if (common_parent === undefined) {
			return;
		}
		if (ALittleIDE.g_IDEEnum.can_move_child_map[common_parent.user_info.default.__class] === undefined) {
			return;
		}
		let shift = (A_UISystem.sym_map.get(1073742049) !== undefined || A_UISystem.sym_map.get(1073742053) !== undefined);
		for (let [target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			let delta_x = event.delta_x;
			let delta_y = event.delta_y;
			if (shift) {
				if (handle_info.lock_x_or_y) {
					delta_y = 0;
				} else {
					delta_x = 0;
				}
			}
			let old_abs_x = event.abs_x - delta_x;
			let old_abs_y = event.abs_y - delta_y;
			let [old_rel_x, old_rel_y] = target.user_info.object.show_parent.GlobalToLocalMatrix2D(old_abs_x, old_abs_y);
			let [new_rel_x, new_rel_y] = target.user_info.object.show_parent.GlobalToLocalMatrix2D(event.abs_x, event.abs_y);
			delta_x = new_rel_x - old_rel_x;
			delta_y = new_rel_y - old_rel_y;
			target.DragXY(delta_x, delta_y);
			this.UpdateHandleQuadLayout(target);
			handle_info.delta_x = handle_info.delta_x + delta_x;
			handle_info.delta_y = handle_info.delta_y + delta_y;
		}
	},
	HandleHandleQuadDragEnd : function(event) {
		let revoke_bind = ALittle.NewObject(ALittleIDE.IDERevokeBind);
		let has_target = false;
		for (let [target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			has_target = true;
			let revoke = ALittle.NewObject(ALittleIDE.IDEDragXYRevoke, target, handle_info.delta_x, handle_info.delta_y);
			revoke_bind.PushRevoke(revoke);
		}
		if (has_target === false) {
			return;
		}
		this._revoke_list.PushRevoke(revoke_bind);
	},
	HandleHandleQuadRButtonDown : function(event) {
		let handle_info = event.target._user_data;
		let target = handle_info.target;
		if (this._control_tabchild_menu === undefined) {
			this._control_tabchild_menu = ALittleIDE.g_Control.CreateControl("ide_control_tabchild_menu", this);
		}
		this._right_control_tree_textedit.disabled = ALittleIDE.g_IDEEnum.text_edit_display_map[target.user_info.default.__class] === undefined;
		this._right_control_tree_up.disabled = target.user_info.root || target.user_info.child_type !== "child";
		this._right_control_tree_down.disabled = target.user_info.root || target.user_info.child_type !== "child";
		this._right_control_tree_add.disabled = !target.IsTree();
		this._right_control_tree_add_image.disabled = !target.IsTree();
		this._right_control_tree_add_text.disabled = !target.IsTree();
		this._right_control_tree_cut.disabled = target.user_info.root;
		this._right_control_tree_jump.disabled = !target.user_info.extends_root;
		this._right_control_tree_delete.disabled = target.user_info.root;
		this._right_control_tree_replace.disabled = target.user_info.root;
		this._control_tabchild_menu._user_data = target;
		this._control_tabchild_menu.x = A_UISystem.mouse_x;
		this._control_tabchild_menu.y = A_UISystem.mouse_y;
		if (this._control_tabchild_menu.x + this._control_tabchild_menu.width > A_UISystem.view_width) {
			this._control_tabchild_menu.x = A_UISystem.view_width - this._control_tabchild_menu.width;
		}
		if (this._control_tabchild_menu.y + this._control_tabchild_menu.height > A_UISystem.view_height) {
			this._control_tabchild_menu.y = A_UISystem.view_height - this._control_tabchild_menu.height;
		}
		A_LayerManager.ShowFromRight(this._control_tabchild_menu);
	},
	HandleHandleSizeQuadKeyDown : function(event) {
	},
	HandleHandleSizeQuadDragBegin : function(event) {
		let target_handle_info = event.target._user_data;
		let target = target_handle_info.target;
		let parent = target.logic_parent;
		if (parent !== undefined && ALittleIDE.g_IDEEnum.can_move_child_map[parent.user_info.default.__class] === undefined) {
			return;
		}
		for (let [target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			handle_info.delta_width = 0;
			handle_info.delta_height = 0;
			handle_info.lock_width_or_height = ALittle.Math_Abs(event.delta_x) > ALittle.Math_Abs(event.delta_y);
		}
		this.Save(false);
	},
	HandleHandleSizeQuadDrag : function(event) {
		let handle_info = event.target._user_data;
		let target = handle_info.target;
		let parent = target.logic_parent;
		if (parent !== undefined && ALittleIDE.g_IDEEnum.can_move_child_map[parent.user_info.default.__class] === undefined) {
			return;
		}
		let shift = (A_UISystem.sym_map.get(1073742049) !== undefined || A_UISystem.sym_map.get(1073742053) !== undefined);
		let delta_x = event.delta_x;
		let delta_y = event.delta_y;
		if (shift) {
			if (handle_info.lock_width_or_height) {
				delta_y = 0;
			} else {
				delta_x = 0;
			}
		}
		let old_abs_x = event.abs_x - delta_x;
		let old_abs_y = event.abs_y - delta_y;
		let [old_rel_x, old_rel_y] = target.user_info.object.GlobalToLocalMatrix2D(old_abs_x, old_abs_y);
		let [new_rel_x, new_rel_y] = target.user_info.object.GlobalToLocalMatrix2D(event.abs_x, event.abs_y);
		delta_x = new_rel_x - old_rel_x;
		delta_y = new_rel_y - old_rel_y;
		let quad_width = handle_info.handle_quad.width + delta_x;
		if (quad_width < 0) {
			delta_x = -handle_info.handle_quad.width;
		}
		let quad_height = handle_info.handle_quad.height + delta_y;
		if (quad_height < 0) {
			delta_y = -handle_info.handle_quad.height;
		}
		target.DragWH(delta_x, delta_y);
		handle_info.handle_quad.width = handle_info.handle_quad.width + delta_x;
		handle_info.handle_quad.height = handle_info.handle_quad.height + delta_y;
		handle_info.delta_width = handle_info.delta_width + delta_x;
		handle_info.delta_height = handle_info.delta_height + delta_y;
		this.UpdateHandleQuadLayout(target);
	},
	HandleHandleSizeQuadDragEnd : function(event) {
		let handle_info = event.target._user_data;
		let target = handle_info.target;
		let revoke = ALittle.NewObject(ALittleIDE.IDEDragWHRevoke, target, handle_info.delta_width, handle_info.delta_height);
		this._revoke_list.PushRevoke(revoke);
	},
	HandleHandleSizeQuadMoveIn : function(event) {
		ALittle.System_SetHVDragCursor();
	},
	HandleHandleSizeQuadMoveOut : function(event) {
		ALittle.System_SetNormalCursor();
	},
	HandleRightControlTreeUp : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		target.TransferUp();
	},
	HandleRightControlTreeDown : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		target.TransferDown();
	},
	HandleRightControlTreeAdd : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		ALittleIDE.g_IDEControlTree.ShowAddDialog(target);
	},
	HandleRightControlTreeAddImage : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		let func = this.ImagePathSelectCallback.bind(this, target);
		ALittleIDE.g_IDEAttrImageDialog.ShowDialog(undefined, func);
	},
	ImagePathSelectCallback : function(target, path) {
		if (target.CanAddChild() === false) {
			ALittleIDE.g_IDETool.ShowNotice("提示", "当前控件不能添加子控件");
			return;
		}
		let tree_object = target.TreeAdd("", "Image", "child");
		if (tree_object === undefined) {
			ALittleIDE.g_IDETool.ShowNotice("提示", "添加失败");
			return;
		}
		tree_object.attr_panel.SetTextureName(path, undefined);
		tree_object.ShowFocus(false);
	},
	HandleRightControlTreeAddText : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		if (target.CanAddChild() === false) {
			ALittleIDE.g_IDETool.ShowNotice("提示", "当前控件不能添加子控件");
			return;
		}
		let tree_object = target.TreeAdd("", "Text", "child");
		if (tree_object === undefined) {
			ALittleIDE.g_IDETool.ShowNotice("提示", "添加失败");
			return;
		}
		tree_object.ShowFocus(false);
	},
	HandleRightControlTreeCopy : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		let copy_list = [];
		let copy_list_count = 0;
		for (let [target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			let info = {};
			info.index = handle_info.target.logic_parent.GetChildIndex(handle_info.target);
			info.info = handle_info.target.CalcInfo();
			++ copy_list_count;
			copy_list[copy_list_count - 1] = info;
		}
		if (copy_list_count > 0) {
			ALittle.List_Sort(copy_list, ALittleIDE.IDETabChild.ControlCopyInfoCmp);
			ALittle.System_SetClipboardText(ALittle.String_JsonEncode(copy_list));
		}
	},
	RightControlTreePasteImpl : function(target, copy_list, child_index, revoke_bind, callback) {
		if (copy_list === undefined) {
			let text_info = ALittle.System_GetClipboardText();
			if (text_info === undefined) {
				ALittleIDE.g_IDETool.ShowNotice("错误", "剪切板的内容不能粘帖");
				if (callback !== undefined) {
					callback(false, undefined);
				}
				return;
			}
			let [error, copy_list_tmp] = (function() { try { let ___VALUE = ALittle.String_JsonDecode.call(undefined, text_info); return [undefined, ___VALUE]; } catch (___ERROR) { return [___ERROR.message]; } }).call(this);
			if (error !== undefined || ALittle.List_MaxN(copy_list_tmp) === 0) {
				ALittleIDE.g_IDETool.ShowNotice("错误", "剪切板的内容不能粘帖");
				if (callback !== undefined) {
					callback(false, undefined);
				}
				return;
			}
			copy_list = copy_list_tmp;
		}
		let ___OBJECT_1 = copy_list;
		for (let k = 1; k <= ___OBJECT_1.length; ++k) {
			let info = ___OBJECT_1[k - 1];
			if (info === undefined) break;
			if (info.info.__class === undefined && info.info.__extends === undefined) {
				ALittleIDE.g_IDETool.ShowNotice("错误", "剪切板的内容不能粘帖");
				if (callback !== undefined) {
					callback(false, undefined);
				}
				return;
			}
		}
		let clazz = target.user_info.default.__class;
		if (ALittleIDE.g_IDEEnum.can_add_child_map[clazz] && ALittleIDE.g_IDEEnum.child_show_map[clazz] === undefined) {
			let add_list = [];
			let add_list_count = 0;
			let inner_revoke_bind = ALittle.NewObject(ALittleIDE.IDERevokeBind);
			let ___OBJECT_2 = copy_list;
			for (let k = 1; k <= ___OBJECT_2.length; ++k) {
				let info = ___OBJECT_2[k - 1];
				if (info === undefined) break;
				if (k === 1) {
					let tree_object = target.TreePaste(info.info, "child", child_index, false, inner_revoke_bind);
					++ add_list_count;
					add_list[add_list_count - 1] = tree_object;
				} else {
					let tree_object = target.TreePaste(info.info, "child", child_index, true, inner_revoke_bind);
					++ add_list_count;
					add_list[add_list_count - 1] = tree_object;
				}
			}
			if (revoke_bind !== undefined) {
				revoke_bind.PushRevoke(inner_revoke_bind);
			} else {
				this._revoke_list.PushRevoke(inner_revoke_bind);
			}
			if (callback !== undefined) {
				callback(true, add_list);
			}
		} else {
			ALittleIDE.g_IDEControlTree.ShowPasteDialog(target, copy_list[1 - 1].info, child_index, revoke_bind, callback);
		}
	},
	HandleRightControlTreePaste : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		if (target.IsTree()) {
			this.RightControlTreePasteImpl(target);
		} else {
			let common_parent = target.logic_parent;
			let child_index = 1;
			if (common_parent === undefined) {
				common_parent = target;
			} else {
				child_index = common_parent.GetChildIndex(target);
			}
			this.RightControlTreePasteImpl(common_parent, undefined, child_index);
		}
	},
	HandleRightControlTreeDelete : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		let revoke_bind = ALittle.NewObject(ALittleIDE.IDERevokeBind);
		let has_target = false;
		for (let [target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			handle_info.target.TreeDelete(revoke_bind);
			has_target = true;
		}
		if (has_target) {
			this._tab_quad_map = new Map();
			this._tab_quad_container.RemoveAllChild();
			this._revoke_list.PushRevoke(revoke_bind);
		}
	},
	HandleRightControlTreeCut : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		let copy_list = [];
		let copy_list_count = 0;
		for (let [target, handle_info] of this._tab_quad_map) {
			if (handle_info === undefined) continue;
			let info = {};
			info.index = handle_info.target.logic_parent.GetChildIndex(handle_info.target);
			info.info = handle_info.target.CalcInfo();
			++ copy_list_count;
			copy_list[copy_list_count - 1] = info;
		}
		if (copy_list_count > 0) {
			ALittle.List_Sort(copy_list, ALittleIDE.IDETabChild.ControlCopyInfoCmp);
			ALittle.System_SetClipboardText(ALittle.String_JsonEncode(copy_list));
			let revoke_bind = ALittle.NewObject(ALittleIDE.IDERevokeBind);
			for (let [target, handle_info] of this._tab_quad_map) {
				if (handle_info === undefined) continue;
				handle_info.target.TreeCut(revoke_bind);
			}
			this._revoke_list.PushRevoke(revoke_bind);
		}
	},
	HandleRightControlTreeJump : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		let extends_name = target.user_info.base.__extends;
		let control_info = ALittleIDE.g_IDEProject.project.control_map[extends_name];
		if (control_info === undefined) {
			ALittleIDE.g_IDETool.ShowNotice("错误", "控件不存在:" + extends_name);
			return;
		}
		ALittleIDE.g_IDETabManager.StartEditControlBySelect(control_info.name, control_info.info);
	},
	HandleRightControlTreeReplace : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		ALittleIDE.g_IDEControlTree.ShowReplaceDialog(target);
	},
	HandleRightControlTreeTextEdit : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		let object = target.user_info.object;
		if (this._control_tabchild_textinput === undefined) {
			this._control_tabchild_textinput = ALittleIDE.g_Control.CreateControl("ide_rename_image_input", this);
			this._control_tabchild_textinput.width = 200;
			A_LayerManager.AddToModal(this._control_tabchild_textinput);
		}
		this._control_tabchild_textinput.visible = true;
		let [x, y] = object.LocalToGlobal();
		this._control_tabchild_textinput.text = object.text;
		this._control_tabchild_textinput.x = x;
		this._control_tabchild_textinput.y = y;
		this._control_tabchild_textinput._user_data = target;
		this._control_tabchild_textinput.SelectAll();
		A_UISystem.focus = this._control_tabchild_textinput.show_input;
	},
	HandleRightControlTreeFocus : function(event) {
		A_LayerManager.HideFromRight(this._control_tabchild_menu);
		let target = this._control_tabchild_menu._user_data;
		this._control_tabchild_menu._user_data = undefined;
		this.ShowTreeItemFocus(target);
	},
	HandleRenameConfirm : function(event) {
		let target = this._control_tabchild_textinput._user_data;
		if (target === undefined) {
			return;
		}
		this._control_tabchild_textinput._user_data = undefined;
		this._control_tabchild_textinput.visible = false;
		let text = this._control_tabchild_textinput.text;
		if (text === "") {
			return;
		}
		target.ChangeText(text);
	},
	ShowTreeItemFocus : function(target) {
		if (this._tree_object === undefined) {
			return;
		}
		if (target !== this._tree_object) {
			let parent = target.logic_parent;
			while (parent !== undefined && parent !== this._tree_object) {
				parent.fold = true;
				parent = parent.logic_parent;
			}
		}
		this._tree_object.fold = true;
		this._tree_screen.RejustScrollBar();
		let [x, y] = target.LocalToGlobal(this._tree_screen.container);
		let target_x = (this._tree_screen.view_width - target.width / 2) / 2 - x;
		let target_y = (this._tree_screen.view_height - target.height) / 2 - y;
		if (this._tree_loop_x !== undefined) {
			this._tree_loop_x.Stop();
			this._tree_loop_x = undefined;
		}
		if (this._tree_loop_y !== undefined) {
			this._tree_loop_y.Stop();
			this._tree_loop_y = undefined;
		}
		this._tree_loop_x = ALittle.NewObject(ALittle.LoopLinear, this._tree_screen, "container_x", target_x, 300, 0);
		this._tree_loop_x.Start();
		this._tree_loop_y = ALittle.NewObject(ALittle.LoopLinear, this._tree_screen, "container_y", target_y, 300, 0);
		this._tree_loop_y.Start();
	},
	SearchLink : function(name) {
		if (this._tree_object === undefined) {
			return;
		}
		if (this._tree_search_info.name !== name) {
			this._tree_search_info.name = name;
			this._tree_search_info.index = 0;
		}
		let list = this._tree_object.SearchLink(name);
		let count = ALittle.List_MaxN(list);
		if (count === 0) {
			return;
		}
		this._tree_search_info.index = this._tree_search_info.index + 1;
		this._tree_search_info.index = this._tree_search_info.index % (count + 1);
		let target = list[this._tree_search_info.index - 1];
		this.ShowTreeItemFocus(target);
		target.ShowAttributePanel();
		this.ShowHandleQuad(target);
	},
	SearchEvent : function(name) {
		if (this._tree_object === undefined) {
			return;
		}
		if (this._tree_search_info.name !== name) {
			this._tree_search_info.name = name;
			this._tree_search_info.index = 0;
		}
		let list = this._tree_object.SearchEvent(name);
		let count = ALittle.List_MaxN(list);
		if (count === 0) {
			return;
		}
		this._tree_search_info.index = this._tree_search_info.index + 1;
		this._tree_search_info.index = this._tree_search_info.index % (count + 1);
		let target = list[this._tree_search_info.index - 1];
		this.ShowTreeItemFocus(target);
		target.ShowAttributePanel();
		this.ShowHandleQuad(target);
	},
	SearchDescription : function(name) {
		if (this._tree_object === undefined) {
			return;
		}
		if (this._tree_search_info.name !== name) {
			this._tree_search_info.name = name;
			this._tree_search_info.index = 0;
		}
		let list = this._tree_object.SearchDescription(name);
		let count = ALittle.List_MaxN(list);
		if (count === 0) {
			return;
		}
		this._tree_search_info.index = this._tree_search_info.index + 1;
		this._tree_search_info.index = this._tree_search_info.index % (count + 1);
		let target = list[this._tree_search_info.index - 1];
		this.ShowTreeItemFocus(target);
		target.ShowAttributePanel();
		this.ShowHandleQuad(target);
	},
	SearchTargetClass : function(name) {
		if (this._tree_object === undefined) {
			return;
		}
		if (this._tree_search_info.name !== name) {
			this._tree_search_info.name = name;
			this._tree_search_info.index = 0;
		}
		let list = this._tree_object.SearchTargetClass(name);
		let count = ALittle.List_MaxN(list);
		if (count === 0) {
			return;
		}
		this._tree_search_info.index = this._tree_search_info.index + 1;
		this._tree_search_info.index = this._tree_search_info.index % (count + 1);
		let target = list[this._tree_search_info.index - 1];
		this.ShowTreeItemFocus(target);
		target.ShowAttributePanel();
		this.ShowHandleQuad(target);
	},
	SearchTextureName : function(name) {
		if (this._tree_object === undefined) {
			return;
		}
		if (this._tree_search_info.name !== name) {
			this._tree_search_info.name = name;
			this._tree_search_info.index = 0;
		}
		let list = this._tree_object.SearchTextureName(name);
		let count = ALittle.List_MaxN(list);
		if (count === 0) {
			return;
		}
		this._tree_search_info.index = this._tree_search_info.index + 1;
		this._tree_search_info.index = this._tree_search_info.index % (count + 1);
		let target = list[this._tree_search_info.index - 1];
		this.ShowTreeItemFocus(target);
		target.ShowAttributePanel();
		this.ShowHandleQuad(target);
	},
	QuickDragAddControl : function(abs_x, abs_y, control_name) {
		if (this._tree_object === undefined) {
			return;
		}
		let [screen_x, screen_y] = this._tab_screen.LocalToGlobal();
		if (abs_x < screen_x || abs_y < screen_y || abs_x > screen_x + this._tab_screen.width || abs_y > screen_y + this._tab_screen.height) {
			return;
		}
		let [global_x, global_y] = this._tab_handle_quad.LocalToGlobal();
		let list = [];
		this._tree_object.QuickPickUp(abs_x - global_x, abs_y - global_y, list);
		let count = ALittle.List_MaxN(list);
		if (count === 0) {
			return;
		}
		let user_data = {};
		user_data.abs_x = abs_x;
		user_data.abs_y = abs_y;
		user_data.control_name = control_name;
		if (count === 1) {
			this.QuickDragAddStart(list[1 - 1], user_data);
			return;
		}
		if (this._quick_right_exmenu === undefined) {
			this._quick_right_exmenu = ALittleIDE.g_Control.CreateControl("ide_quick_drag_menu", this);
		}
		this._quick_right_exlinear.RemoveAllChild();
		let ___OBJECT_3 = list;
		for (let index = 1; index <= ___OBJECT_3.length; ++index) {
			let tree = ___OBJECT_3[index - 1];
			if (tree === undefined) break;
			let item = ALittleIDE.g_Control.CreateControl("ide_common_item_button");
			item.AddEventListener(___all_struct.get(-449066808), this, this.HandleQuickRightExItemClick);
			item._user_data = tree;
			item.text = tree.title;
			this._quick_right_exlinear.AddChild(item);
		}
		let item = ALittleIDE.g_Control.CreateControl("ide_common_item_button");
		item.AddEventListener(___all_struct.get(-449066808), this, this.HandleQuickRightExItemClick);
		item._user_data = undefined;
		item.text = "取消";
		this._quick_right_exlinear.AddChild(item);
		this._quick_right_exmenu.height = this._quick_right_exlinear.height + 5;
		if (abs_x + this._quick_right_exmenu.width > A_UISystem.view_width) {
			abs_x = A_UISystem.view_width - this._quick_right_exmenu.width;
		}
		this._quick_right_exmenu.x = abs_x;
		this._quick_right_exmenu.y = abs_y;
		this._quick_right_exmenu._user_data = user_data;
		A_LayerManager.ShowFromRight(this._quick_right_exmenu);
	},
	HandleQuickRightExItemClick : function(event) {
		A_LayerManager.HideFromRight(this._quick_right_exmenu);
		this._quick_right_exlinear.RemoveAllChild();
		let user_data = this._quick_right_exmenu._user_data;
		let tree = event.target._user_data;
		if (tree === undefined) {
			return;
		}
		this.QuickDragAddStart(tree, user_data);
	},
	QuickDragAddStart : function(tree, user_data) {
		let revoke_bind = ALittle.NewObject(ALittleIDE.IDERevokeBind);
		let display_info = {};
		display_info.__extends = user_data.control_name;
		let info = {};
		info.index = 1;
		info.info = display_info;
		let copy_list = [];
		copy_list[1 - 1] = info;
		this.RightControlTreePasteImpl(tree, copy_list, tree.child_count + 1, revoke_bind, this.QuickDragAddEnd.bind(this, tree, user_data, revoke_bind));
	},
	QuickDragAddEnd : function(tree, user_data, revoke_bind, result, add_list) {
		if (result === false) {
			return;
		}
		let [global_x, global_y] = tree.user_info.object.LocalToGlobal();
		let ___OBJECT_4 = add_list;
		for (let k = 1; k <= ___OBJECT_4.length; ++k) {
			let tree_object = ___OBJECT_4[k - 1];
			if (tree_object === undefined) break;
			tree_object.attr_panel.SetXType(1, revoke_bind);
			tree_object.attr_panel.SetYType(1, revoke_bind);
			tree_object.attr_panel.SetXValue(user_data.abs_x - global_x, revoke_bind);
			tree_object.attr_panel.SetYValue(user_data.abs_y - global_y, revoke_bind);
		}
		this._revoke_list.PushRevoke(revoke_bind);
	},
}, "ALittleIDE.IDETabChild");

}